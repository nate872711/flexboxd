services:
  watchweave:
    image: nate8727/watchweave:latest
    container_name: watchweave
    restart: unless-stopped
    ports:
      - "8089:8089"

    environment:
      # ðŸŒ General
      - TZ=Etc/UTC #Timezone=America/Chicago
      - LOG_LEVEL=INFO

      # ðŸŽ¬ Plex
      - PLEX_ENABLED=true
      - PLEX_SERVER_URL=http://plex.local:32400
      - PLEX_TOKEN=YOUR_PLEX_TOKEN
      - PLEX_USERNAME=YOUR_PLEX_USERNAME

      # ðŸ“ˆ Tautulli
      - TAUTULLI_ENABLED=true
      - TAUTULLI_API_URL=http://tautulli.local:8181/api/v2
      - TAUTULLI_API_KEY=YOUR_TAUTULLI_API_KEY

      # ðŸŽžï¸ Trakt
      - TRAKT_ENABLED=true
      - TRAKT_CLIENT_ID=YOUR_TRAKT_CLIENT_ID
      - TRAKT_CLIENT_SECRET=YOUR_TRAKT_CLIENT_SECRET
      - TRAKT_ACCESS_TOKEN=YOUR_TRAKT_ACCESS_TOKEN
      - TRAKT_REFRESH_TOKEN=YOUR_TRAKT_REFRESH_TOKEN

      # ðŸŽ¥ Letterboxd
      - LETTERBOXD_ENABLED=true
      - LETTERBOXD_USERNAME=YOUR_LETTERBOXD_USERNAME
      - LETTERBOXD_PASSWORD=YOUR_LETTERBOXD_PASSWORD

      # ðŸŽ¬ IMDb
      - IMDB_ENABLED=true
      - IMDB_CSV_PATH=/config/imdb_ratings.csv

      # ðŸ”„ Sync
      - SYNC_INTERVAL_MINUTES=30
      - SYNC_DIRECTION=plex->trakt,letterboxd,imdb

    volumes:
      - ./config:/config
      - ./logs:/logs

    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:8089/health || exit 1"]
      interval: 60s
      timeout: 10s
      retries: 3
      start_period: 20s
